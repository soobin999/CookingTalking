<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>건호 리스트 뿌리기</title>
<link rel="stylesheet" type="text/css" href="css/style.css">
<link rel="stylesheet" type="text/css" th:href="@{css/bootstrap.css}">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

</head>
<body>

	<div class="adSelectPage" id="adSelectPage">
		<!-- 재료 리스트 가져오기 -->
		<button onclick="adQnaList()">고객요청함</button>
	</div>
	<div class="adSelectPage" id="adSelectPage">
		<button onclick="adUserList()">회원정보</button>
	</div>

	<!-- 레시피 화명 이동 버튼 -->
	<div class="adSelectRcpPage" id="adSelectPage">
		<div class="w3-dropdown-hover">
			<button class="w3-button w3-black">레시피</button>
			<div class="w3-dropdown-content w3-bar-block w3-border">
				<a href="#" class="w3-bar-item w3-button">레시피 리스트</a> <a href="#"
					class="w3-bar-item w3-button">레시피 통계</a>
			</div>
		</div>
	</div>


	<div class="adSelectPage" id="adSelectPage">
		<button onclick="adIngrList()">재료페이지</button>
	</div>
	<br>
	<br>


	<div id="basic">


		<table class="table table-bordered table-striped">
			<thead>
				<tr>
					<th>문의사항제목</th>
					<th>문의 내용</th>
					<th>문의 날짜</th>
					<th>유저</th>
					<th>답변 유무</th>
				</tr>
			</thead>
			<tbody th:each="qna, qnaStat:${qnaList}" th:id='${qnaStat.index}'>
				<tr>
					<td>
						<button type="button" class="btn" th:text="${qna.qnaTitle}"
							th:id="|btn_open${qnaStat.index}|" name="btn_qna"></button>
					</td>
					<td>
						<div th:text="${qna.qnaCont}"></div>
					</td>
					<td>
						<div th:text="${qna.qnaDate}"></div>
					</td>
					<td>
						<div th:text="${qna.UserId}"></div>
					</td>
					<td>
						<div>답변유무</div>
					</td>

				</tr>
				<tr th:id="|open${qnaStat.index}|" class="collapse out">
					<td><div>작성자</div>
						<div>
							<input th:id="|UserId_answer${qnaStat.index}|" name="userId"
								th:value="${qna.userId}" readonly>
						</div></td>
					<td><div th:text="${qna.answer}"></div></td>
					<td><input type="text" th:id="|answer_answer${qnaStat.index}|"
						th:name="answer" th:value="${qna.answer}" placeholder="답글을 입력하세요">
					</td>
					<td><button type="button"
							th:id="|button_answer${qnaStat.index}|" th:name="button_button"
							class="insert_answer_btn">답변하기</button></td>
					<td><div></div></td>

				</tr>
			</tbody>
		</table>
		<ul>
			<li th:each="num: ${#numbers.sequence(1,IngrList)}"><a
				th:class="page" th:text="${num}" th:value="${num}"></a></li>
		</ul>


	</div>
	<script>
		$(document).ready(function() {

			var cc = 700;
			for (var i = 20; i < cc; i++) {
				$('#' + i).hide();
			}
		});
	</script>
	<script>
		$('.page').click(function(event) {
			var k = event.target.text;
			console.log(k);
			for (var i = 0; i < 670; i++) {
				$('#' + i).hide();
			}
			for (var i = 0; i < 20; i++) {
				$('#' + ((parseInt(k) - 1) * 20 + parseInt(i))).show();
				console.log(k + i);
			}
		});
	</script>

	<script type="text/javascript">
		$(".insert_answer_btn").click(function() {
			var reply = $(this).attr('id').substring(7);

			var UserID = document.getElementsByName('userId');
			var UserID = document.getElementById('UserId_' + reply);
			var answer_reply = document.getElementById('answer_' + reply);
			console.log(reply);
			console.log(UserID.value);

			$.ajax({
				url : '/admin/qnaAnswer',
				method : "POST",
				data : {
					answer : answer_reply.value,
					userId : UserID.value
				},
			}).done(function(response) {
				alert("문의사항 답변을 작성하였습니다.")
				location.reload();
			});
		});
	</script>
	<script>
		$(".btn").click(function() {
			var k = $(this).attr('id').substring(4);
			//#은 아래 th:id 값을 나타내는것이므로, #하나+k(|btn_open${qnaStat.index}|에서 앞에 4글자를 뺀 글자.)로 결국에는  아이디. hasclass("out")가 가능해진다. 
			if ($("#" + k).hasClass("out")) {
				$("#" + k).addClass("in");
				$("#" + k).removeClass("out");
			} else {
				$("#" + k).addClass("out");
				$("#" + k).removeClass("in");
			}
		});
	</script>


	<script>
		function adUserList() {
			$('#mainTable').remove();
			$('#basic').load("admin/adUser");

		};
		//고객요청함 불러오기
		function adQnaList() {
			$('#mainTable').remove();
			$('#basic').load("admin/adQnaList");

		};
		//재료 추가함 불러오기 		
		function adIngrList() {
			$('#mainTable').remove();
			$('#basic').load("admin/adIngrList");

		};
	</script>
</body>
</html>